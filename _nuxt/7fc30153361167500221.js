(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{214:function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return m}));n(18);var r=n(49),o=n.n(r),c=(n(215),n(69)),l=function(t,e,n,r){o.a.auth().signInWithEmailAndPassword(t,e).then((function(t){m("loginCount",t.user.uid),n(t.user.uid)})).catch((function(t){r(t.message)}))},f=function(t){o.a.auth().signOut().then(t)},d=function(t){var e=t.uid,n=t.city,r=t.nickname;return new Promise((function(t,o){c.b.ref("users/".concat(e)).update({city:n,nickname:r},(function(e){e?o(e):t()}))}))},v=function(t){return new Promise((function(e){c.b.ref("users/".concat(t)).once("value").then((function(t){return e(t.val())}))}))},m=function(t,e){return new Promise((function(n,r){console.log("rrrr","users/".concat(e,"/").concat(t)),c.b.ref("users/".concat(e,"/").concat(t)).transaction((function(t){return null===t?1:t+1}),(function(t,e){null===t&&e&&n(),r(t)}))}))}},217:function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));n(37);var r=n(5),o=(n(71),n(18),n(49)),c=n.n(o),l=(n(350),n(69));function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=l.b.ref("users");return new Promise((function(l,f){var d=c.a.storage().ref(),v={contentType:t.type},m=Date.now()+t.name,h=d.child(m).put(t,v);h.on("state_changed",n,(function(){}),Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.child(e).once("value");case 3:if(n=t.sent,!(r=n.val())||!r.filename){t.next=8;break}return t.next=8,c.a.storage().ref().child(r.filename).delete();case 8:return t.next=10,h.snapshot.ref.getDownloadURL();case 10:d=t.sent,o.child(e).update({filename:m}),l(d),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.log("happen error",t.t0),f(t.t0);case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))))}))}function d(t){return new Promise((function(e){l.b.ref("users").child(t).once("value",function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(n){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=n.val())||!r.filename){t.next=6;break}return t.next=4,c.a.storage().ref().child(r.filename).getDownloadURL();case 4:o=t.sent,e(o);case 6:e(null);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}},218:function(t,e,n){"use strict";n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return v}));n(20),n(70),n(18),n(37);var r=n(5),o=n(69).b.ref("favorite"),c=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e,n,caption){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.child(e).child(n).set({caption:caption,addTime:Date.now()});case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),l=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o.child(e).child(n).remove();case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),f=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){o.child(e).once("value",(function(e){var n=e.val();t(n||{})}))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){o.child(e).once("value",(function(e){var n=e.val();t(n||{})}))})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(e);case 2:return n=t.sent,n=Object.keys(n),t.abrupt("return",n.length);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},371:function(t,e,n){var content=n(421);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("6941f6c1",content,!0,{sourceMap:!1})},372:function(t,e,n){"use strict";var r=n(373),o=n.n(r);e.default=o.a},373:function(t,e){},374:function(t,e,n){var content=n(425);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("5c9f657d",content,!0,{sourceMap:!1})},375:function(t,e,n){var content=n(427);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("70f3d73f",content,!0,{sourceMap:!1})},376:function(t,e,n){var content=n(429);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("780b8e5c",content,!0,{sourceMap:!1})},382:function(t,e,n){"use strict";var r=n(4),o=n(23),c=n(32),l=n(98),f=n(73),d=n(14),v=n(51).f,m=n(75).f,h=n(12).f,x=n(418).trim,w=r.Number,y=w,k=w.prototype,C="Number"==c(n(74)(k)),_="trim"in String.prototype,N=function(t){var e=f(t,!1);if("string"==typeof e&&e.length>2){var n,r,o,c=(e=_?e.trim():x(e,3)).charCodeAt(0);if(43===c||45===c){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===c){switch(e.charCodeAt(1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+e}for(var code,l=e.slice(2),i=0,d=l.length;i<d;i++)if((code=l.charCodeAt(i))<48||code>o)return NaN;return parseInt(l,r)}}return+e};if(!w(" 0o1")||!w("0b1")||w("+0x1")){w=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof w&&(C?d((function(){k.valueOf.call(n)})):"Number"!=c(n))?l(new y(N(e)),n,w):N(e)};for(var O,R=n(9)?v(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;R.length>I;I++)o(y,O=R[I])&&!o(w,O)&&h(w,O,m(y,O));w.prototype=k,k.constructor=w,n(15)(r,"Number",w)}},418:function(t,e,n){var r=n(8),o=n(31),c=n(14),l=n(419),f="["+l+"]",d=RegExp("^"+f+f+"*"),v=RegExp(f+f+"*$"),m=function(t,e,n){var o={},f=c((function(){return!!l[t]()||"​"!="​"[t]()})),d=o[t]=f?e(h):l[t];n&&(o[n]=d),r(r.P+r.F*f,"String",o)},h=m.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(d,"")),2&e&&(t=t.replace(v,"")),t};t.exports=m},419:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},420:function(t,e,n){"use strict";var r=n(371);n.n(r).a},421:function(t,e,n){(e=n(26)(!1)).push([t.i,".masker{position:fixed;z-index:999;top:0;bottom:0;left:0;right:0;background:hsla(0,0%,48.2%,.43137)}",""]),t.exports=e},422:function(t,e,n){"use strict";var r=n(442),o=n(372),c=(n(424),n(25)),component=Object(c.a)(o.default,r.a,r.b,!1,null,"8f65d7da",null);e.default=component.exports},423:function(t,e,n){t.exports=n.p+"img/93bc879.png"},424:function(t,e,n){"use strict";var r=n(374);n.n(r).a},425:function(t,e,n){(e=n(26)(!1)).push([t.i,".tip-wrap[data-v-8f65d7da]{display:flex;justify-content:flex-end;align-items:center;color:#929090;max-width:50%;float:right}.tip-wrap>.animal[data-v-8f65d7da]{width:30px;height:30px;margin-right:10px;vertical-align:top;align-self:start}",""]),t.exports=e},426:function(t,e,n){"use strict";var r=n(375);n.n(r).a},427:function(t,e,n){(e=n(26)(!1)).push([t.i,".statistics-wrap[data-v-36d0e4fe]{background:#000;width:100%;flex-wrap:wrap;margin-top:20px}.circle-wrap[data-v-36d0e4fe],.statistics-wrap[data-v-36d0e4fe]{display:flex;justify-content:center}.circle-wrap[data-v-36d0e4fe]{width:100px;height:100px;border-radius:50%;background:#fff;margin:10px;align-items:center}",""]),t.exports=e},428:function(t,e,n){"use strict";var r=n(376);n.n(r).a},429:function(t,e,n){(e=n(26)(!1)).push([t.i,'.profileWrapper{padding-top:10px;display:flex;flex-direction:column}.avatarWrap{border-radius:50%;background:#eceaea;width:250px;height:250px;margin:auto;position:relative}.avatarWrap>img{width:100%;height:100%;padding:14px;border-radius:50%}.avatarWrap .pickPic{font-size:30px;position:absolute;bottom:0;right:0;color:#fff;background-color:silver;padding:5px;border-radius:4px;border-top-left-radius:15px}#picPic{display:none}.settingWrap{padding:15px}.profileWrapper ul{list-style-type:none;padding:0}.profileWrapper input{border:0;border-bottom:1px solid grey;width:100%;margin:15px 0;color:#726363;outline:0}.updateInfo{text-align:center}.updateInfo>li{text-align:left;width:100%}.updateInfo>li:after{content:"";clear:both;display:table}.personal-setting-wrap{overflow:auto;max-width:900px;margin:auto}.unsave-warn{box-shadow:0 0 1px 1px #ef9797}',""]),t.exports=e},442:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var r=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip-wrap"},[e("img",{staticClass:"animal",attrs:{src:n(423),alt:"animal-cat"}}),this._v(" "),e("p",[this._t("default")],2)])},o=[]},445:function(t,e,n){"use strict";n.r(e);n(37);var r=n(5),picture=n(217),o=(n(382),{props:{loadingTime:{default:0,type:Number}},data:function(){return{maxLoadingTime:100}}}),c=(n(420),n(25)),l=Object(c.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"masker d-flex justify-content-center align-items-center px-2"},[e("b-progress",{staticClass:"w-100",attrs:{max:this.maxLoadingTime,height:"1.5rem"}},[e("b-progress-bar",{attrs:{value:this.loadingTime,label:this.loadingTime+"%"}})],1)],1)}),[],!1,null,null,null).exports,f=n(422),d={props:{commitCount:{type:Number,default:0},replyCount:{type:Number,default:0},favoriteCount:{type:Number,default:0},loginCount:{type:Number,default:0}}},v=(n(426),Object(c.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"statistics-wrap"},[n("div",{staticClass:"circle-wrap"},[t._v("\n    留言數:\n    "+t._s(t.commitCount)+"\n  ")]),t._v(" "),n("div",{staticClass:"circle-wrap"},[t._v("\n    回覆數:\n    "+t._s(t.replyCount)+"\n  ")]),t._v(" "),n("div",{staticClass:"circle-wrap"},[t._v("\n    收藏數:\n    "+t._s(t.favoriteCount)+"\n  ")]),t._v(" "),n("div",{staticClass:"circle-wrap"},[t._v("\n    登入數:\n    "+t._s(t.loginCount)+"\n  ")])])}),[],!1,null,"36d0e4fe",null).exports),m=n(214),h=n(218),x={components:{skeketon:l,tip:f.default,recordStatistics:v},data:function(){return{imgUrl:null,progress:0,cityOptions:[{value:"請選擇居住城市",text:"請選擇居住城市",disabled:!0},{value:"臺北市",text:"臺北市"},{value:"新北市",text:"新北市"},{value:"桃園市",text:"桃園市"},{value:"臺中市",text:"臺中市"},{value:"臺南市",text:"臺南市"},{value:"高雄市",text:"高雄市"},{value:"新竹縣",text:"新竹縣"},{value:"苗栗縣",text:"苗栗縣"},{value:"彰化縣",text:"彰化縣"},{value:"南投縣",text:"南投縣"},{value:"雲林縣",text:"雲林縣"},{value:"嘉義縣",text:"嘉義縣"},{value:"屏東縣",text:"屏東縣"},{value:"宜蘭縣",text:"宜蘭縣"},{value:"花蓮縣",text:"花蓮縣"},{value:"臺東縣",text:"臺東縣"},{value:"澎湖縣",text:"澎湖縣"},{value:"金門縣",text:"金門縣"},{value:"連江縣",text:"連江縣"},{value:"基隆市",text:"基隆市"},{value:"新竹市",text:"新竹市"},{value:"嘉義市",text:"嘉義市"}],city:"",nickname:"",isUserChange:!1,commitCount:0,replyCount:0,favoriteCount:0,loginCount:0}},created:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l,f,d,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$store.state.authentication,e.next=3,Object(picture.a)(n);case 3:return r=e.sent,e.next=6,Object(m.b)(n);case 6:return o=e.sent,c=o.city,l=o.nickname,f=o.commitCount,d=o.replyCount,v=o.loginCount,console.log(f),t.imgUrl=r,t.city=c,t.nickname=l,t.commitCount=f,t.replyCount=d,t.loginCount=v,e.next=21,Object(h.b)(t.$store.state.authentication);case 21:t.favoriteCount=e.sent;case 22:case"end":return e.stop()}}),e)})))()},methods:{handlePic:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.$store.dispatch("setShowSkeketon",!0),n.prev=1,n.next=4,Object(picture.b)(t.target.files[0],e.$store.state.authentication,e.handleUploadProgress);case 4:r=n.sent,e.imgUrl=r,e.$store.dispatch("setShowSkeketon",!1),e.progress=0,n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),alert("發生錯誤...");case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},handleUploadProgress:function(t){this.progress=t.bytesTransferred/t.totalBytes*100},rotateLeave:function(t){this.active=t},userChange:function(){this.isUserChange=!0},submitSettting:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.dispatch("setLoading",!0),e.prev=1,e.next=4,Object(m.c)({city:t.city,nickname:t.nickname,uid:t.$store.state.authentication});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:t.$store.dispatch("setLoading",!1);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})))()}}},w=(n(428),Object(c.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"profileWrapper"},[n("div",{staticClass:"personal-setting-wrap"},[n("div",{staticClass:"avatarWrap"},[t.imgUrl?n("img",{attrs:{src:t.imgUrl}}):t._e(),t._v(" "),n("label",{attrs:{for:"picPic"}},[n("font-awesome-icon",{staticClass:"pickPic",attrs:{icon:"images"}})],1),t._v(" "),n("input",{attrs:{id:"picPic",type:"file",accept:"image/*"},on:{change:t.handlePic}})]),t._v(" "),n("div",{staticClass:"settingWrap"},[n("ul",{staticClass:"updateInfo"},[n("li",[n("b-form-select",{attrs:{options:t.cityOptions},on:{change:t.userChange},model:{value:t.city,callback:function(e){t.city=e},expression:"city"}}),t._v(" "),n("tip",[t._v("\n            當選擇你的居住城市後，將自動優先推薦您這些城市的景點唷!!\n          ")])],1),t._v(" "),n("li",[n("b-form-input",{attrs:{placeholder:"您的暱稱"},on:{input:t.userChange},model:{value:t.nickname,callback:function(e){t.nickname="string"==typeof e?e.trim():e},expression:"nickname"}}),t._v(" "),n("tip",[t._v("您的暱稱將於評論中顯示出來唷!!")])],1),t._v(" "),n("li",{staticClass:"text-right pt-1"},[n("b-button",{class:{"unsave-warn":t.isUserChange},attrs:{variant:"success"},on:{click:t.submitSettting}},[t._v("\n            存檔\n          ")])],1)])])]),t._v(" "),n("recordStatistics",{attrs:{"commit-count":t.commitCount,"reply-count":t.replyCount,"favorite-count":t.favoriteCount,"login-count":t.loginCount}}),t._v(" "),t.$store.state.showSkeleton?n("skeketon",{attrs:{"loading-time":t.progress}}):t._e()],1)}),[],!1,null,null,null));e.default=w.exports}}]);